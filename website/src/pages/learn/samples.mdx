---
title: Échantillons
layout: ../../layouts/MainLayout.astro
---

import { MiniRepl } from '../../docs/MiniRepl';
import { JsDoc } from '../../docs/JsDoc';

# Échantillons

Les échantillons sont le moyen le plus courant de produire du son avec Tidal et Strudel.
Un échantillon est un (généralement court) morceau d'audio qui est utilisé comme base pour la génération de son, subissant diverses transformations.
La musique basée sur des échantillons peut être considérée comme un collage de sons. [En savoir plus sur l'échantillonnage](<https://en.wikipedia.org/wiki/Sampling_(music)>)

Strudel permet de charger des échantillons sous forme de fichiers audio de différents formats (wav, mp3, ogg) depuis n'importe quelle URL publiquement accessible.

# Échantillons par défaut

Par défaut, Strudel est livré avec une "carte d'échantillons" intégrée, offrant une base solide pour jouer.

<MiniRepl client:idle tune={`s("bd sd [~ bd] sd,hh*16, misc")`} />

Ici, nous utilisons la fonction `s` pour lire différents échantillons par défaut (`bd`, `sd`, `hh` et `misc`) pour obtenir un rythme de batterie.

Pour les sons de batterie, Strudel utilise la bibliothèque complète [tidal-drum-machines](https://github.com/ritchse/tidal-drum-machines), avec la convention de nommage suivante :

| Batterie              | Abréviation |
| --------------------- | ----------- |
| Grosse caisse         | bd          |
| Caisse claire         | sd          |
| Rimshot               | rim         |
| Clap                  | cp          |
| Charleston fermée     | hh          |
| Charleston ouverte    | oh          |
| Cymbale crash         | cr          |
| Cymbale ride          | rd          |
| Tom aigu              | ht          |
| Tom médium            | mt          |
| Tom grave             | lt          |

<img src="/img/drumset.png" />

<a class="text-right text-xs" href="https://de.wikipedia.org/wiki/Schlagzeug#/media/Datei:Drum_set.svg" target="_blank">
  original de Pbroks13
</a>

Plus de sons percussifs :

| Source                                  | Abréviation |
| --------------------------------------- | ----------- |
| Shakers (et maracas, cabasas, etc)      | sh          |
| Cowbell                                 | cb          |
| Tambourin                               | tb          |
| Autres percussions                      | perc        |
| Échantillons divers                     | misc        |
| Effets                                  | fx          |

De plus, Strudel charge également des échantillons d'instruments depuis [VCSL](https://github.com/sgossner/VCSL) par défaut.

Pour voir quels noms d'échantillons sont disponibles, ouvrez l'onglet `sounds` dans le [REPL](https://strudel.cc/).

Vous pouvez également créer des alias personnalisés pour les sons existants en utilisant la fonction `soundAlias` :

<MiniRepl
  client:idle
  tune={`soundAlias("RolandTR808_bd", "kick")
s("kick")`}
/>

Notez que seules les cartes d'échantillons (mappant les noms aux URLs) sont chargées initialement, tandis que les échantillons audio eux-mêmes ne sont pas chargés tant qu'ils ne sont pas réellement joués.
Ce comportement de chargement des choses uniquement quand elles sont nécessaires est également appelé `chargement paresseux`.
Bien qu'il économise des ressources, il peut également conduire à ce que les sons ne soient pas audibles la première fois qu'ils sont déclenchés, car le son est encore en cours de chargement.
[Cela pourrait être corrigé à l'avenir](https://codeberg.org/uzu/strudel/issues/187)

# Banques de sons

Si nous ouvrons l'onglet `sounds` puis `drum-machines`, nous pouvons voir que les échantillons de batterie sont tous préfixés avec des noms de boîtes à rythmes : `RolandTR808_bd`, `RolandTR808_sd`, `RolandTR808_hh` etc..

Nous _pourrions_ les utiliser comme ceci :

<MiniRepl client:idle tune={`s("RolandTR808_bd RolandTR808_sd,RolandTR808_hh*16")`} />

... mais c'est évidemment un peu long à écrire. En utilisant la fonction `bank`, nous pouvons raccourcir cela à :

<MiniRepl client:idle tune={`s("bd sd,hh*16").bank("RolandTR808")`} />

Vous pourriez même patteriser la banque pour basculer entre différentes boîtes à rythmes :

<MiniRepl client:idle tune={`s("bd sd,hh*16").bank("<RolandTR808 RolandTR909>")`} />

En coulisses, `bank` va simplement ajouter le nom de la boîte à rythmes au nom de l'échantillon avec `_` pour obtenir le nom complet.
Cela ne fonctionne bien sûr que parce que le nom après `_` (`bd`, `sd` etc..) est standardisé.
Notez également que certaines banques n'auront pas d'échantillons pour tous les sons !

# Sélection des sons

Si nous ouvrons à nouveau l'onglet `sounds`, suivi de l'onglet `drum machines`, il y a aussi un numéro derrière chaque nom, indiquant combien d'échantillons individuels sont disponibles.
Par exemple `RolandTR909_hh(4)` signifie qu'il y a 4 échantillons d'un charleston TR909 disponibles.
Par défaut, `s` jouera le premier échantillon, mais nous pouvons sélectionner les autres en utilisant `n`, à partir de 0 :

<MiniRepl client:idle tune={`s("hh*8").bank("RolandTR909").n("0 1 2 3")`} />

Les numéros qui sont trop élevés vont simplement revenir au début

<MiniRepl client:idle tune={`s("hh*8").bank("RolandTR909").n("0 1 2 3 4 5 6 7")`} />

Ici, 0-3 joueront les mêmes sons que 4-7, car `RolandTR909_hh` n'a que 4 sons.

La sélection de sons fonctionne également à l'intérieur de la mini notation, en utilisant "`:'" comme ceci :

<MiniRepl
  client:idle
  tune={`s("bd*4,hh:0 hh:1 hh:2 hh:3 hh:4 hh:5 hh:6 hh:7")
.bank("RolandTR909")`}
/>

# Chargement d'échantillons personnalisés

Vous pouvez charger une carte d'échantillons non standard en utilisant la fonction `samples`.

## Chargement d'échantillons depuis des URLs de fichiers

Dans cet exemple, nous attribuons les noms `bassdrum`, `hihat` et `snaredrum` à des fichiers audio spécifiques sur un serveur :

<MiniRepl
  client:idle
  tune={`samples({
  bassdrum: 'bd/BT0AADA.wav',
  hihat: 'hh27/000_hh27closedhh.wav',
  snaredrum: ['sd/rytm-01-classic.wav', 'sd/rytm-00-hard.wav'],
}, 'https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/');
 
s("bassdrum snaredrum:0 bassdrum snaredrum:1, hihat*16")`}
/>

Vous pouvez librement choisir n'importe quelle combinaison de lettres pour chaque nom d'échantillon. Il est même possible de remplacer les sons par défaut.
Les noms que vous choisissez seront disponibles dans la fonction `s`.
Assurez-vous que l'URL et chaque chemin d'échantillon forment une URL correcte !

Dans l'exemple ci-dessus, `bassdrum` chargera :

```
https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/bd/BT0AADA.wav
|----------------------chemin de base ----------------------------------|--chemin échantillon-|
```

Notez que nous pouvons soit charger un seul fichier, comme pour `bassdrum` et `hihat`, soit une liste de fichiers comme pour `snaredrum` !
Dès que vous exécutez le code, vos noms d'échantillons choisis seront listés dans `sounds` -> `user`.

## Chargement d'échantillons depuis un fichier strudel.json

La méthode ci-dessus pour charger des échantillons peut être fastidieuse à écrire/copier-coller chaque fois que vous écrivez un nouveau pattern.
Pour éviter cela, vous pouvez simplement passer une URL vers un fichier `strudel.json` quelque part sur internet :

<MiniRepl
  client:idle
  tune={`samples('https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/strudel.json')
s("bd sd bd sd,hh*16")`}
/>

Le fichier doit définir une carte d'échantillons en utilisant JSON, dans le même format que décrit ci-dessus.
De plus, le chemin de base peut être défini avec la clé `_base`.
La dernière section pourrait être écrite comme :

```json
{
  "_base": "https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/",
  "bassdrum": "bd/BT0AADA.wav",
  "snaredrum": "sd/rytm-01-classic.wav",
  "hihat": "hh27/000_hh27closedhh.wav"
}
```

Veuillez noter que les navigateurs mettent souvent en cache `strudel.json` lors du premier chargement, et continuent d'utiliser la version en cache même si l'original a été mis à jour. Si cela vous pose problème (par exemple lors du développement d'un nouveau pack d'échantillons), vous pouvez forcer le navigateur à télécharger une nouvelle copie en changeant par exemple la casse d'un caractère dans l'URL, ou en ajoutant un attribut d'URL, tel que :

```javascript
samples('https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/strudel.json?version=2');
```

qui est ignoré par GitHub (mais change l'URL, forçant le navigateur à recharger chaque fois que nous augmentons le numéro de version).

Il est également possible, bien sûr, de simplement le supprimer du cache (en supprimant le cache dans les paramètres de confidentialité du navigateur, ou depuis la console de développement si vous êtes techniquement averti, ou en utilisant une extension de suppression de cache).

## Génération de strudel.json

Vous pouvez utiliser [@strudel/sampler](https://www.npmjs.com/package/@strudel/sampler) pour générer un fichier strudel.json pour vous, en exécutant :

```sh
npx --yes @strudel/sampler --json > strudel.json
```

Voir d'autres utilisations de strudel/sampler plus bas, sous "Depuis le disque via @strudel/sampler".

## Raccourci Github

Parce que le chargement d'échantillons depuis GitHub est courant, il existe un raccourci :

<MiniRepl
  client:idle
  tune={`samples('github:tidalcycles/dirt-samples')
s("bd sd bd sd,hh*16")`}
/>

Le format est `samples('github:<utilisateur>/<repo>/<branche>')`. Si vous omettez `branche` (comme ci-dessus), la branche `main` sera utilisée.
Il suppose qu'un fichier `strudel.json` soit présent à la racine du dépôt :

```
https://raw.githubusercontent.com/<utilisateur>/<repo>/<branche>/strudel.json
```

## Depuis le disque via "Import Sounds Folder"

Si vous ne voulez pas télécharger vos échantillons sur internet, vous pouvez également les charger depuis votre disque local.
Allez dans l'onglet `sounds` dans le REPL et ouvrez l'onglet `import-sounds` sous la barre de recherche.
Appuyez sur le bouton "import sounds folder" et sélectionnez un dossier contenant des fichiers audio.
Le dossier que vous sélectionnez peut également contenir des sous-dossiers avec des fichiers audio.
Exemple :

```
└─ samples
   ├─ swoop
   │  ├─ swoopshort.wav
   │  ├─ swooplong.wav
   │  └─ swooptight.wav
   └─ smash
      ├─ smashhigh.wav
      ├─ smashlow.wav
      └─ smashmiddle.wav
```

Dans l'exemple ci-dessus, le dossier `samples` contient 2 sous-dossiers `swoop` et `smash`, qui contiennent des fichiers audio.
Si vous sélectionnez ce dossier `samples`, l'onglet `user` (à côté de l'onglet `import-sounds`) contiendra alors 2 nouveaux sons : `swoop(3) smash(3)`
Les échantillons individuels peuvent alors être joués normalement comme `s("swoop:0 swoop:1 smash:2")`.
Les échantillons de chaque son utilisent une indexation basée sur zéro par ordre alphabétique.

## Depuis le disque via @strudel/sampler

Au lieu de charger vos échantillons dans votre navigateur avec le bouton "import sounds folder", vous pouvez également servir les échantillons depuis un serveur de fichiers local.
Le moyen le plus simple de le faire est d'utiliser [@strudel/sampler](https://www.npmjs.com/package/@strudel/sampler) :

```sh
cd samples
npx @strudel/sampler
```

Ensuite, vous pouvez le charger via :

<MiniRepl
  client:idle
  tune={`samples('http://localhost:5432/');
 
n("<0 1 2>").s("swoop smash")`}
/>

L'avantage de `@strudel/sampler` est qu'il génère automatiquement le fichier `strudel.json` en fonction de votre structure de dossiers.
Vous pouvez voir ce qu'il a généré en allant sur `http://localhost:5432` avec votre navigateur.

Remarque : Vous devez avoir [NodeJS](https://nodejs.org/) installé sur votre système pour que cela fonctionne.

## Spécification de la hauteur

Pour vous assurer que vos échantillons sont accordés lorsque vous les jouez avec `note`, vous pouvez spécifier une hauteur de base comme ceci :

<MiniRepl
  client:idle
  tune={`samples({
  'gtr': 'gtr/0001_cleanC.wav',
  'moog': { 'g3': 'moog/005_Mighty%20Moog%20G3.wav' },
}, 'github:tidalcycles/dirt-samples');
note("g3 [bb3 c4] <g4 f4 eb4 f3>@2").s("gtr,moog").clip(1)
  .gain(.5)`}
/>

Nous pouvons également déclarer différents échantillons pour différentes régions du clavier :

<MiniRepl
  client:idle
  tune={`setcpm(60)
samples({
  'moog': {
    'g2': 'moog/004_Mighty%20Moog%20G2.wav',
    'g3': 'moog/005_Mighty%20Moog%20G3.wav',
    'g4': 'moog/006_Mighty%20Moog%20G4.wav',
  }}, 'github:tidalcycles/dirt-samples')

note("g2!2 <bb2 c3>!2, <c4@3 [<eb4 bb3> g4 f4]>")
.s('moog').clip(1)
.gain(.5)`}
/>

Le sampler choisira toujours l'échantillon le plus proche correspondant à la note actuelle !

Notez que cette notation pour les sons à hauteur déterminée fonctionne également à l'intérieur d'un fichier `strudel.json`.

## Shabda

Si vous ne voulez pas sélectionner les échantillons à la main, il existe également le merveilleux outil appelé [shabda](https://shabda.ndre.gr/).
Avec lui, vous pouvez entrer n'importe quel nom(s) d'échantillon à interroger depuis [freesound.org](https://freesound.org/). Exemple :

<MiniRepl
  client:idle
  tune={`samples('shabda:bass:4,hihat:4,rimshot:2')

$: n("0 1 2 3 0 1 2 3").s('bass')
$: n("0 1*2 2 3*2").s('hihat').clip(1)
$: n("~ 0 ~ 1 ~ 0 0 1").s('rimshot')`}
/>

Vous pouvez également générer des échantillons de voix artificiels avec n'importe quel texte, dans plusieurs langues.
Notez que le code de langue et les paramètres de genre sont optionnels et par défaut `en-GB` et `f`

<MiniRepl
  client:idle
  tune={`samples('shabda/speech:the_drum,forever')
samples('shabda/speech/fr-FR/m:magnifique')

$: s("the_drum*2").chop(16).speed(rand.range(0.85,1.1))
$: s("forever magnifique").slow(4).late(0.125)`}
/>

# Effets d'échantillonneur

Les effets d'échantillonneur sont des fonctions qui peuvent être utilisées pour changer le comportement de la lecture d'échantillons.

### begin

<JsDoc client:idle name="Pattern.begin" h={0} />

### end

<JsDoc client:idle name="Pattern.end" h={0} />

### loop

<JsDoc client:idle name="loop" h={0} />

### loopBegin

<JsDoc client:idle name="loopBegin" h={0} />

### loopEnd

<JsDoc client:idle name="loopEnd" h={0} />

### cut

<JsDoc client:idle name="cut" h={0} />

### clip

<JsDoc client:idle name="clip" h={0} />

### loopAt

<JsDoc client:idle name="Pattern.loopAt" h={0} />

### fit

<JsDoc client:idle name="fit" h={0} />

### chop

<JsDoc client:idle name="Pattern.chop" h={0} />

### striate

<JsDoc client:idle name="Pattern.striate" h={0} />

### slice

<JsDoc client:idle name="Pattern.slice" h={0} />

### splice

<JsDoc client:idle name="splice" h={0} />

### scrub

<JsDoc client:idle name="Pattern.scrub" h={0} />

### speed

<JsDoc client:idle name="speed" h={0} />

Après les échantillons, voyons ce que les [Synthés](/learn/synths) nous offrent.
