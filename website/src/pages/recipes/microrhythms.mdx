---
title: Microrythmes
layout: ../../layouts/MainLayout.astro
---

import { MiniRepl } from '../../docs/MiniRepl';

voir https://strudel.cc/?zMEo5kowGrFc

# Microrythmes

Inspiré par cette [Mini-Conférence sur la Notation des Microrythmes](https://www.youtube.com/watch?v=or7B6vI3jOo), voyons comment nous pouvons exprimer les microrythmes avec Strudel.

Les horodatages du premier rythme sont `0 1/5 1/2 2/3 1`. Nous pourrions naïvement exprimer cela avec un stack :

<MiniRepl
  client:idle
  tune={`s("hh").struct(
  stack(
    "x", // 0
    "~ x ~@3", // 1/5
    "~ x", // 1/2
    "~@2 x" // 2/3
))`}
/>

Bien que cela fonctionne, cela présente deux problèmes :

- ce n'est pas très compact
- les durées sont incorrectes, par exemple la première note occupe tout le cycle

Dans la vidéo, la durée d'un horodatage est calculée en le soustrayant de l'horodatage suivant :

- 1/5 - 0 = 1/5 = 6/30
- 1/2 - 1/5 = 3/10 = 9/30
- 2/3 - 1/2 = 1/6 = 5/30
- 1 - 2/3 = 1/3 = 10/30

En utilisant ceux-ci, nous pouvons maintenant exprimer le rythme de manière beaucoup plus courte :

<MiniRepl client:idle tune={`s("hh").struct("x@6 x@9 x@5 x@10")`} />

Les problèmes de la première notation sont maintenant résolus : c'est beaucoup plus court et les durées sont correctes.
Cependant, cette notation implique de calculer les durées à la main, ce qui pourrait être automatisé :

<MiniRepl
  client:idle
  tune={`Pattern.prototype.micro = function (...timestamps) {
  const durations = timestamps.map((x, i, a) => {
    const next = i < a.length-1 ? a[i+1] : 1;
    return next - a[i]
  })
  return this.struct(timeCat(...durations.map(d => [d, 1]))).late(timestamps[0])
}
s('hh').micro(0, 1/5, 1/2, 2/3)`}
/>

Cette notation est encore plus courte et elle permet de remplir directement les horodatages !

Voici le deuxième exemple de la vidéo :

<MiniRepl
  client:idle
  tune={`Pattern.prototype.micro = function (...timestamps) {
  const durations = timestamps.map((x, i, a) => {
    const next = i < a.length-1 ? a[i+1] : 1;
    return next - a[i]
  })
  return this.struct(timeCat(...durations.map(d => [d, 1]))).late(timestamps[0])
}
s('hh').micro(0, 1/6, 2/5, 2/3, 3/4)`}
/>

avec basse : https://strudel.cc/?sTglgJJCPIeY
